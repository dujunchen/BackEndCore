### 简单动态字符串

1. 在redis中，C字符串只作为字符串字面量（无须对字符串进行修改）使用。而使用自己构建的简单动态字符串类型（SDS）来表示需要动态修改的字符串。
2. 每个SDS类型由三个属性组成：len、free、buf。free表示SDS的未使用空间，len表示已使用空间（所保存字符串的长度），buf表示保存字符串的字节数组。SDS遵循C字符串的规则，数组末尾会自动分配一个字节空间用以保存空字符串（'\0'），这个字节空间不计算在len中，所以SDS可以直接重用部分C字符串函数库中的函数。
3. Redis采用SDS而不采用C字符串的原因：
   - 获取字符串长度操作复杂度不同。C字符串的复杂度是O(N)，SDS的复杂度是O(1)。
   - 修改字符串时，C字符串API可能会造成缓冲区溢出或者内存泄露。SDS会动态扩展空间，不会导致缓冲区溢出。
   - 修改字符串时，C字符串API的N次修改必然会导致N次内存重分配。内存重分配涉及复杂算法或者执行系统调用，比较耗时，影响性能。SDS采用空间预分配和惰性空间释放两种优化策略使得N次修改最多N次重分配。
   - 因为C字符串以空字符串（\0）作为结束标志，字符串中不能包含空字符串，只能用来保存文本数据，无法保存二进制数据。而SDS是以处理二进制方式处理SDS中的数据，不仅可以保存文本数据，还可以保存任意格式的二进制数据。
4. SDS在redis中的应用
   - 保存数据库中的字符串
   - AOF和客户端输入状态中的缓冲区